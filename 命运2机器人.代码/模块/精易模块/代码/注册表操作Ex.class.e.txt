.版本 2

.程序集 注册表操作Ex, , 公开, 注册表操作,包括注册表的读,写.支持64位
.子程序 关闭键Ex, 整数型, 公开, 关闭一个已经打开的键句柄,关闭之后需要重新调用打开键Ex才能进行其他操作,如果已经关闭则返回-1
    

.子程序 打开键Ex, 整数型, 公开, 如果键不存在,则失败.成功键的句柄,失败返回-1,通过取最后错误查看错误码;注意,使用该命令时,如果键已打开,则自动关闭键后在执行本操作
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test

    

.子程序 创建并打开键Ex, 整数型, 公开, 如果键不存在,则创建一个键之后打开,如果键存在则直接打开;返回键的句柄,失败返回-1,通过取最后错误查看错误码;
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test

    

.子程序 枚举子项Ex, 整数型, 公开, 枚举指定项名称下的子项(成功返回子项目数,失败返回-1);
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 子项, 文本型, 参考 可空 数组, 获取的子项数组

    

.子程序 方法_取最后错误代码Ex, 整数型, 公开, 取出这个值后,可以根据GetlastError获取错误信息
    

.子程序 枚举键信息Ex, 整数型, 公开, 枚举指定项名称下的键信息(成功返回键名数,失败返回-1),需要先调用打开键Ex或打开键Ex2
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 注册表键信息, 注册表_键, 参考 数组, 作为返回值返回

    

.子程序 键是否存在Ex, 逻辑型, 公开, 判断键是否存在,亦可可以直接使用"打开键Ex"进行判断
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test

    

.子程序 读取键值Ex, 整数型, 公开, 成功返回0,失败返回错误码.需要先调用打开键Ex或打开键Ex2
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 键名称, 文本型, , 键的名称
    .参数 项目信息_out, 注册表_键, 参考, 用于返回的

    

.子程序 写入键值Ex_文本, 整数型, 公开, 成功返回0,失败返回错误码；注意，该函数只能写入文本型的值
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 键名称, 文本型, , 键的名称
    .参数 欲写入值, 字节集, , 使用 到字节集()
    .参数 写入类型, 整数型, , 只适用于：REG_SZ;REG_EXPAND_SZ;REG_MULTI_SZ;#REG_BINARY
    .参数 是否自动创建, 逻辑型, 可空, 如果不存在的话，是否创建该键

    

.子程序 写入键值Ex_数值, 整数型, 公开
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 键名称, 文本型, , 键的名称
    .参数 欲写入值, 长整数型, , 注意。理论上：DWORD最大值为：4294967295  QWORD最大值为：18446744073709551615，但是QWORD最大值超过了整数型的最大长度，请谨慎使用
    .参数 写入类型, 整数型, , 只适用于：#REG_DWORD;#REG_DWORD_BIG_ENDIAN;
    .参数 是否自动创建, 逻辑型, 可空, 如果不存在的话，是否创建该键

    

.子程序 写QWORD_64值, 逻辑型, 公开, 写入64位长整数值,成功返回真,失败返回假.源码由@pp25729391提供。
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 键名称, 文本型, , 键的名称
    .参数 值_十六进制文本, 文本型

    

.子程序 删除键值Ex, 整数型, 公开, 删除一个键值.
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test
    .参数 键名, 文本型

    

.子程序 删除注册表项, 整数型, 公开, 删除整个项,项下面所有的键值将会被自动删除.
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test

    

.子程序 格式化键值类型, 文本型, 公开, 说明键值
    .参数 键值, 整数型, , REG_*

    

.子程序 是否有子项Ex, 整数型, 公开, -1=失败 0=无 1=有
    .参数 键根目录, 整数型, , #HKEY_*开头的常量
    .参数 全路径注册项名, 文本型, , 完整的键路径,不包括"HKEY_*" 例如:SOFTWARE\Test

    

