.版本 2

.程序集 外部树型框, , 公开
.子程序 初始化, 逻辑型, 公开
    .参数 树型框句柄, 整数型
    .参数 树型框类名, 文本型, 可空
    .参数 是否操作外部控件, 逻辑型, 可空

    

.子程序 取项目数, 整数型, 公开, 返回树型框中所有项目的数目。
    

.子程序 取项目句柄数组, 整数型, 公开
    .参数 句柄组, 长整数型, 参考 数组

    

.子程序 取缩进层次, 整数型, 公开, 返回指定项目所处缩进层次，层次值从1开始。如果未找到指定项目，返回 0 。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取缩进层次_句柄, 整数型, 公开
    .参数 项目句柄, 长整数型

    

.子程序 取项目文本, 文本型, 公开, 返回指定项目的文本。如果该项目不存在，将返回空文本。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取项目文本W, 字节集, 公开, 返回指定项目的文本。如果该项目不存在，将返回空文本。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取项目文本_句柄W, 字节集, 公开
    .参数 项目句柄, 长整数型

    

.子程序 取项目文本_句柄, 文本型, 公开
    .参数 项目句柄, 长整数型

    

.子程序 取图片, 整数型, 公开, 返回指定项目的图片索引。如果该项目不存在，将返回 -1 
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取图片_句柄, 整数型, 公开
    .参数 项目句柄, 长整数型

    

.子程序 取选中图片, 整数型, 公开, 返回指定项目被选中后的图片索引。如果该项目不存在，将返回 -1 。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取项目数值, 整数型, 公开, 返回与指定项目相关联的数值。如果该项目不存在，将返回 0 。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取项目数值_句柄, 整数型, 公开, 返回与指定项目相关联的数值。如果该项目不存在，将返回 0 。
    .参数 项目句柄, 长整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 置图片, 逻辑型, 公开, 设置在指定项目首部所显示图片的索引。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。

    

.子程序 置选中图片, 逻辑型, 公开, 设置指定项目被选中后所显示图片的索引。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 图片索引, 整数型, , 图片索引用于指定图片组属性中的某张图片，从 0 开始。

    

.子程序 置项目数值, 逻辑型, 公开, 设置与指定项目相关联的数值。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 欲置入的项目数值, 整数型, 可空, 可以被省略。该数值与指定项目相关联。如果本参数被省略，默认值为 0 。

    

.子程序 置项目文本W, 逻辑型, 公开, 设置指定项目的文本。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 欲置入的项目文本, 字节集

    

.子程序 置项目文本, 逻辑型, 公开, 设置指定项目的文本。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 欲置入的项目文本, 文本型

    

.子程序 保证显示, , 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 保证显示_句柄, , 公开
    .参数 项目句柄, 长整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 扩展, , 公开, 将指打开指定项目的下属分枝。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 扩展全部, , 公开
    .参数 不扩展第一项, 逻辑型, 可空

    

.子程序 收缩, , 公开, 缩回指定项目的下属分枝。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 收缩全部, , 公开
    

.子程序 强制刷新, , 公开
    

.子程序 排序, , 公开
    .参数 排序1级缩进, 逻辑型, 可空, 是否排序缩进层次为1的，可空为不排序。
    .参数 排序指定层次, 整数型, 可空, 可空，0=全部排序(默认)，排序大于为等于此值的缩进层次，如：2，将排序缩进层次≥2的项目，-1=不排序

    

.子程序 排序_句柄, , 公开
    .参数 项目句柄, 长整数型

    

.子程序 加入项目, 整数型, 公开, 将单个或一批项目加入到树型框中，如果仅加入一个项目，成功返回加入后该项目所处的位置，失败返回 -1 。如果成批加入项目，成功返回 0 ，失败返回 -1 。成批加入项目可以用作一次性快速加入大量项目到树型框中。
    .参数 父项目索引, 整数型, 可空, 可以被省略。指定欲加入项目所处的父项目，0 为项目一，1 为项目二，如此类推。如果没有父项目（即欲加入项目为顶层项目），请提供值 -1 。如果本参数被省略，默认值为 -1 。
    .参数 项目数据1, 项目数据, 可空, 用于只加入一个项目，如欲批量加入，请留空
    .参数 项目数据2, 项目数据, 可空 数组, 用于批量加入项目
    .参数 加入方式, 整数型, 可空, 可以被省略。默认为 3
    .参数 加入完成后是否排序, 逻辑型, 可空

    

.子程序 加入项目W, 长整数型, 公开
    .参数 父项目句柄, 长整数型, 可空
    .参数 项目文本, 字节集
    .参数 图片索引, 整数型, 可空
    .参数 选中图片索引, 整数型, 可空
    .参数 项目数值, 整数型, 可空
    .参数 是否加粗, 逻辑型, 可空

    

.子程序 删除项目, 逻辑型, 公开, 删除树型框中的指定项目。成功返回真，失败返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 清空, , 公开, 删除树型框中的所有项目。
    

.子程序 取父项目, 整数型, 公开, 返回指定项目的父项目索引。如果该项目为顶层项目，将返回 -1 。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取父项目文本, 文本型, 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 是否有子项目, 逻辑型, 公开, 如果指定项目存在子项目，返回真，否则返回假。如果本命令返回真，意味着指定项目的下一项即为此项目的第一个子项目。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 是否已扩展, 逻辑型, 公开, 如果树型框中的指定项目具有子项目并已扩展显示，返回真，否则返回假。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

    

.子程序 置背景色, , 公开
    .参数 背景颜色, 整数型

    

.子程序 取背景色, 整数型, 公开
    

.子程序 置项目间隔, , 公开
    .参数 间隔距离, 整数型, 可空, 默认为16

    

.子程序 取项目间隔, 整数型, 公开
    

.子程序 置文本颜色, , 公开
    .参数 文本颜色, 整数型

    

.子程序 取文本颜色, 整数型, 公开
    

.子程序 置连线颜色, , 公开
    .参数 连线颜色, 整数型

    

.子程序 取连线颜色, 整数型, 公开
    

.子程序 使用复选框, , 公开
    

.子程序 使用热点跟踪, , 公开
    

.子程序 禁止滚动条, 逻辑型, 公开, 返回禁止的状态
    .参数 禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真

    

.子程序 禁止水平滚动条, 逻辑型, 公开, 返回禁止的状态
    .参数 禁止, 逻辑型, 可空, 真为禁止，假为解除禁止。默认为真

    

.子程序 使用整行选择, 逻辑型, 公开, 要使用本功能，就不能使用显示连线。
    .参数 是否使用, 逻辑型, 可空, 真为使用，假为不使用。默认为真。

    

.子程序 是否选中, 逻辑型, 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 是否自动更新数据, 逻辑型, 可空, 可以被省略。选择是否自动进行数据更新。当为真时，每次读取数据时都会对数据进行刷新，可能会因此而减慢速度。默认值为“置自动更新状态”方法所设置的状态。

    

.子程序 选中项目, 逻辑型, 公开, 操作成功返回真
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。
    .参数 是否选中, 逻辑型, 可空, 可以被省略。设置项目的选中状态，默认为真。

    

.子程序 加粗, , 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 加粗_句柄, , 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取消加粗, , 公开, 将指定项目的标题取消加粗显示。
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取可显示数量, 整数型, 公开, 取当前在树形框的用户区中大约可以显示的项目数量
    

.子程序 取第一项索引, 整数型, 公开, 取在当前树形框中显示的第一条项目的索引。失败返回-1
    

.子程序 取现行选中项, 整数型, 公开
    

.子程序 置现行选中项, , 公开
    .参数 项目索引, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 置现行选中项_句柄, , 公开
    .参数 项目句柄, 整数型, , 0 为项目一，1 为项目二，如此类推。

    

.子程序 取全部选中项, 变体型, 公开, 返回选中项索引数组
    

.子程序 更新缓存, , 公开, 如果项目增加或减少，需要调用此命令进行更新
    

.子程序 置外部操作, , 公开
    .参数 是否操作外部控件, 逻辑型

    

.子程序 遍历句柄_子项目, 整数型, 公开, 遍历指定父项目下的所有子项目句柄
    .参数 父项目句柄, 整数型
    .参数 项目数据, 项目数据, 参考 可空 数组
    .参数 是否提取项目数值, 逻辑型, 可空

    

.子程序 句柄取索引, 整数型, 公开, 用树型框的项目句柄获取他的项目索引
    .参数 欲查找句柄, 整数型

    

.子程序 索引取句柄, 整数型, 公开, 失败返回-1
    .参数 项目索引, 整数型, , 从0开始

    

.子程序 查找项目, 整数型, 公开, 成功返回项目索引
    .参数 项目文本, 文本型
    .参数 精确查找, 逻辑型, 可空, 可空，默认为假，真=精确查找
    .参数 项目句柄, 整数型, 参考 可空

    

.子程序 查找项目数值, 整数型, 公开, 成功返回索引
    .参数 项目数值, 整数型

    

.子程序 查找项目_外部, 整数型, 公开, 返回结果数量，被查找出来的项目数值，对应目标树型框的项目索引
    .参数 欲查找的文本, 文本型
    .参数 结果树型框句柄, 整数型, , 用于存放结果的树型框句柄
    .参数 查找结果是否扩展, 逻辑型, 可空, 查找后，结果项目是否扩展开
    .参数 是否同步图标, 逻辑型, 可空, 是否同步项目的图标，会影响速度
    .参数 搜索时禁止重绘, 逻辑型, 可空, 禁止重绘，可能会导致未找到时(只有1个项目时，无法重绘)
    .参数 搜索状态回调Call, 整数型, 可空, 共2个参数，参数1:状态文本(文本型)，参数2:备用(整数)

    

.子程序 取子项目数, 整数型, 公开, 获取当前选中项目的子项目数量
    .参数 项目索引, 整数型, 可空, 可空，默认取选中项的子项目数

    

.子程序 双击项目, , 公开
    .参数 项目句柄, 长整数型

    

.子程序 取所有父项目, 整数型, 公开, 获取所有有子项目的项目索引，成功返回获取到的数量
    .参数 项目索引数组, 整数型, 参考 数组, 用于存放父项目索引的数组
    .参数 排除父项目, 文本型, 可空, 如：类，将不获取类下的所有有子项目的父项目索引
    .参数 缩进层次, 整数型, 可空, 可空，默认为所有。获取小于或等于这个层次的父项目，缩进层次从1开始
    .参数 指定缩进层次, 整数型, 可空, 可空，默认为所有。如果有指定，第23参数将无效，只获取指定缩进层次的父项目

    

.子程序 取上一个同级项目, 整数型, 公开
    .参数 项目索引, 整数型

    

.子程序 取下一个同级项目, 整数型, 公开
    .参数 项目索引, 整数型

    

