.版本 2
.支持库 e2ee
.支持库 CommonSupport

.程序集 程序集1
.子程序 _启动子程序, 整数型, , 请在本子程序中放置易模块初始化代码
    
    _临时子程序 () ' 在初始化代码执行完毕后调用测试代码
    返回 (0) ' 可以根据您的需要返回任意数值

.子程序 _临时子程序
    ' 本名称子程序用作测试程序用，仅在开发及调试环境中有效，编译发布程序前将被系统自动清空，请将所有用作测试的临时代码放在本子程序中。 ***注意不要修改本子程序的名称、参数及返回值类型。
    
    

.子程序 时间_取日期, 文本型
    .局部变量 时间, 日期时间型

    时间 ＝ 取现行时间 ()
    返回 (到文本 (取年份 (时间)) ＋ “-” ＋ 到文本 (取月份 (时间)) ＋ “-” ＋ 到文本 (取日 (时间)))
    

.子程序 时间检测
    .参数 保存路径, 文本型
    .参数 文件名, 文本型
    .局部变量 时间, 日期时间型
    .局部变量 日志文件名, 文本型

    .判断循环首 (真)
        时间 ＝ 取现行时间 ()
        .如果真 (取小时 (时间) ＝ 0 且 取分钟 (时间) ＝ 0 且 取秒 (时间) ＝ 0)
            日志文件名 ＝ 保存路径 ＋ 文件名 ＋ 时间_取日期 () ＋ “.txt”
            .如果真 (路径_是否为文件 (日志文件名) ＝ 假)
                写到文件 (日志文件名, { })
            .如果真结束
            
            许可证.进入 ()
            关闭文件 (文件号)
            文件号 ＝ 打开文件 (日志文件名, #改写, #禁止写)
            移动读写位置 (文件号, #文件尾, 0)
            许可证.退出 ()
        .如果真结束
        
        延时 (1000)
    .判断循环尾 ()
    

.子程序 写日志
    .参数 内容, 文本型

    许可证.进入 ()
    写文本行 (文件号, 内容)
    许可证.退出 ()
    

.子程序 写日志_
    .参数 p, 整数型
    .局部变量 编辑框, 整数型
    .局部变量 内容, 文本型

    许可证.进入 ()
    常用_无限传参还原 (p, 编辑框, 内容)
    写文本行 (文件号, 内容)
    外部编辑框_加入文本 (编辑框, 内容 ＋ #换行符)
    许可证.退出 ()
    

.子程序 外部编辑框_加入文本, , , 通过句柄给编辑框添加文本
    .参数 编辑框句柄, 整数型, , 编辑框句柄
    .参数 文本内容, 文本型, , 要添加的内容

    外部编辑框_置起始选择位置 (编辑框句柄, 外部编辑框_取文本长度 (编辑框句柄))
    发送消息文本 (编辑框句柄, 194, 1, 文本内容)
    

.子程序 外部编辑框_置起始选择位置
    .参数 编辑框句柄, 整数型
    .参数 起始选择位置, 整数型

    发送消息整数 (编辑框句柄, 177, 起始选择位置, 起始选择位置)
    

.子程序 外部编辑框_取文本长度, 整数型
    .参数 编辑框句柄, 整数型

    返回 (发送消息整数 (编辑框句柄, 14, 0, 0))
    

.子程序 发送消息文本, 整数型, , 发送特定的消息到一个或多个窗口。该命令不会立即返回，只有在消息被处理完毕后才返回结果。返回值的具体含义随消息的不同而不同
    .参数 窗口句柄, 整数型, , 本参数指定接收消息的窗口的句柄
    .参数 消息号, 整数型, , 本参数指定欲发送的消息
    .参数 消息参数1, 整数型, , 本参数指定消息的第一个参数。具体含义随消息的不同而不同
    .参数 消息参数2, 文本型, , 本参数指定消息的第二个参数。具体含义随消息的不同而不同

    返回 (SendMessageA (窗口句柄, 消息号, 消息参数1, 取指针文本_ (消息参数2)))
    

.子程序 发送消息整数, 整数型, , 发送特定的消息到一个或多个窗口。该命令不会立即返回，只有在消息被处理完毕后才返回结果。返回值的具体含义随消息的不同而不同
    .参数 窗口句柄, 整数型, , 本参数指定接收消息的窗口的句柄
    .参数 消息号, 整数型, , 本参数指定欲发送的消息
    .参数 消息参数1, 整数型, , 本参数指定消息的第一个参数。具体含义随消息的不同而不同
    .参数 消息参数2, 整数型, , 本参数指定消息的第二个参数。具体含义随消息的不同而不同

    返回 (SendMessageA (窗口句柄, 消息号, 消息参数1, 消息参数2))
    

.子程序 取指针文本_, 整数型
    .参数 参数_文本, 文本型

    置入代码 ({ 139, 69, 8, 139, 0, 201, 194, 4, 0 })
    ' mov eax,[ebp+8]
    ' mov eax,[eax]
    ' leave
    ' retn 04
    返回 (0)
    

